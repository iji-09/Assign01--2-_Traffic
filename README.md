# 🚦 Traffic_Assignment01

## 아두이노 동작 영상



---

## 구현 기능

- 🟥 **빨간불 2초 유지**
- 🟨 **첫 번째 노란불 0.5초 유지**
- 🟩 **초록불 2초 유지**
- 🟩 **초록 깜빡임 3회 (1초 동안 166ms 간격)**
- 🟨 **두 번째 노란불 0.5초 유지**
- 💡 **밝기 조절 기능**
- 🚦 **p5.js UI에서 신호등 조작**
- 🔄 **아두이노 ↔ p5.js 양방향 통신**
- 🔘 **버튼으로 신호등 제어 가능 (Red only, Blink, On/Off)**

---

## 하드웨어 설명

### 버튼 연결

총 3개의 버튼이 사용되며, **각 버튼은 아두이노의 디지털 입력 핀과 연결**되어 있습니다.

| 버튼 번호 | 아두이노 핀 | 기능 |
|-----------|-----------|----------------|
| **1번 버튼** | `D4` | Red LED만 점등 / 신호등 기본기능 재시작 |
| **2번 버튼** | `D5` | 모든 LED 깜빡이기 / 신호등 기본기능 재시작 |
| **3번 버튼** | `D6` | 신호등 기본기능 on/off |

**각 버튼은 `INPUT_PULLUP` 모드로 설정되어 있어, 눌렀을 때 LOW 신호를 감지합니다.**  
**인터럽트를 활용하여 버튼을 누를 때마다 즉각적인 반응이 가능하도록 구현되었습니다.**

---

### LED 연결

각 신호등 LED는 아두이노의 **PWM 지원 디지털 핀**에 연결되어 있으며, `analogWrite()` 를 통해 밝기를 조절할 수 있습니다.

| LED 색상 | 아두이노 핀 | 역할 |
|-----------|-----------|----------------|
| **빨간 LED** | `D9` | 신호등 기본기능 (2초) |
| **노란 LED** | `D10` | 신호등 기본기능1 (0.5초) |
| **초록 LED** | `D11` | 신호등 기본기능 (2초), 깜빡임(6회) |
| **노란 LED** | `D10` | 신호등 기본기능2 (0.5초) |

**PWM을 사용하여 밝기를 조절할 수 있도록 설정되었습니다.**

---

### 밝기 조절용 가변저항 (Potentiometer)

신호등 LED의 밝기는 **가변저항(Potentiometer)** 를 사용하여 조절됩니다.

| 구성 요소 | 아두이노 핀 | 역할 |
|-----------|-----------|----------------|
| **가변저항** | `A0` (아날로그 입력) | LED 밝기 조절 |
| **전원 연결** | `5V` 및 `GND` | 아두이노에서 전력 공급 |

**아날로그 입력 핀(`A0`)에서 값을 읽어 0-1023 범위의 값을 받아 0-255로 변환하여 LED 밝기를 조절합니다.**  
**`map()` 함수를 사용하여 가변저항의 입력값을 LED의 `analogWrite()` 값으로 변환합니다.**

---

### 핀 연결 세부사항

| 핀 번호 | 연결된 부품 | 설명 |
|--------|------------|------------------------------------------------|
| **D9**  | 초록 LED(Green) | PWM 출력 핀, 가변저항을 통해 밝기 제어 가능 |
| **D10** | 노랑 LED(Yellow) | PWM 출력 핀, 가변저항을 통해 밝기 제어 가능 |
| **D11** | 빨강 LED(Red) | PWM 출력 핀, 가변저항을 통해 밝기 제어 가능 |
| **D4**  | 버튼1 | 신호등 정지/재시작 버튼, 내부 풀업(Input Pull-up) |
| **D5**  | 버튼2 | 전체 LED 깜빡이기 버튼, 내부 풀업(Input Pull-up) |
| **D6**  | 버튼3 | 신호등 초기화 버튼, 내부 풀업(Input Pull-up) |
| **A0**  | 가변저항 | 0-1023 범위를 읽어 LED 밝기(0-255)로 매핑 |
| **5V/GND** | 전원, 접지 | LED, 버튼, 가변저항에 전력 공급 및 회로 구성 위한 공통 접지 |



## **코드 구성 및 동작 방식**  


✔ redTime, yellowTime, greenTime → 신호등 점등 시간
✔ brightness → LED 밝기 값
✔ currentLight → 현재 점등 중인 신호등 색
✔ mode → "normal" 상태일 때만 신호등이 동작


✔ createCanvas(500, 600); → 500x600 크기의 캔버스 생성
✔ serial = new p5.SerialPort(); → 시리얼 포트 연결을 위한 객체 생성
✔ createButton("아두이노 연결"); → 아두이노 연결 버튼 생성
✔ createSlider(0, 255, 255); → LED 밝기를 조절하는 슬라이더 추가


✔ drawTrafficLights(); → 신호등을 화면에 그리는 함수 호출
✔ updateTrafficLight(); → 신호등 상태를 업데이트하는 함수 호출
✔ brightnessSlider.value(); → 사용자가 선택한 밝기 값 반영



---

# 🚦 p5.js 기반 신호등 시뮬레이션  
이 프로젝트는 **p5.js**를 사용하여 신호등을 시뮬레이션하는 웹 애플리케이션입니다.  
사용자는 슬라이더를 이용해 **신호등의 점등 시간**을 조절하고, **아두이노와 시리얼 통신을 통해 실제 LED를 제어**할 수 있습니다.  

![스크린샷 2025-03-16 111127](https://github.com/user-attachments/assets/d4c9653e-6fad-4c14-9882-1117934f585b)

---

## **📡 아두이노 ↔ p5.js 양방향 데이터 흐름**

### **📡 시리얼 통신 프로토콜**
| 데이터 형식 | 설명 |
|------------|------------------------|
| `1` | 신호등 기능 ON |
| `0` | 신호등 기능 OFF |
| `r` | 빨간불 only |
| `b` | 모든 LED 깜빡이기 |
| `BUTTON1_ON` | 버튼 1이 눌림 (Arduino → p5.js) |
| `BUTTON1_OFF` | 버튼 1에서 손 뗌 (Arduino → p5.js) |
| `BUTTON2_ON` | 버튼 2가 눌림 (Arduino → p5.js) |
| `BUTTON2_OFF` | 버튼 2에서 손 뗌 (Arduino → p5.js) |
| `BUTTON3_ON` | 버튼 3이 눌림 (Arduino → p5.js) |
| `BUTTON3_OFF` | 버튼 3에서 손 뗌 (Arduino → p5.js) |
| `BRIGHTNESS: [0-255]` | 가변저항 밝기 값 (Arduino → p5.js) |
| `BRIGHTNESS_SET: [0-255]` | p5.js에서 설정한 밝기 값 (p5.js → Arduino) |

---

## **실행 방법**
### **1️⃣. 아두이노 코드 업로드**
1. **VS Code**에서 **PlatformIO** 확장 프로그램을 설치  
   - VS Code에서 `Extensions (Ctrl+Shift+X)` → `PlatformIO IDE` 검색 후 설치
2. **프로젝트 열기**  
   - `TrafficLight.ino` 파일이 포함된 폴더를 VS Code에서 엽니다.
3. **아두이노 보드 연결**
   - USB 케이블을 통해 아두이노를 PC에 연결합니다.
4. **코드 업로드 (`Ctrl+Alt+U`)**  
   - VS Code에서 `PlatformIO: Upload` 버튼을 클릭하거나 단축키 `Ctrl+Alt+U`를 눌러 업로드합니다.

### **2️⃣. 웹 UI 실행 (p5.js)**
1. **VS Code Live Server 실행**
   - `Extensions (Ctrl+Shift+X)`에서 `Live Server` 검색 후 설치  
   - `index.html` 파일을 열고 **오른쪽 하단의 "Go Live" 버튼** 클릭  
   - 또는 `Alt+L` → `Alt+O` 단축키를 사용하여 실행  
2. **웹 브라우저에서 접속**
   - `http://127.0.0.1:5500/` 또는 `http://localhost:5500/` 에 접속

### **3️⃣. Arduino 연결 및 조작**
1. **"아두이노 연결/해제" 버튼 클릭** → 시리얼 포트 선택
2. **UI에서 버튼 클릭** 또는 **슬라이더 조절**
3. 아두이노 보드에서 **버튼을 눌러 LED 제어** 가능
4. **가변저항 조절** 시 웹 UI에서 밝기 반영


---

## **마무리**
이 프로젝트는 **Arduino와 p5.js의 양방향 통신을 활용한 신호등 시스템**을 구현하는 예제입니다.  
🔹 **버튼, 가변저항, 시리얼 통신을 연습하기 좋은 프로젝트**입니다!

---
